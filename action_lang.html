<div class="panel panel-default">
  <div class="panel-body">

<h1>Condition/Action language</h1>

<p>The statements in conditions and actions must follow general JavaScript (JS) rules. 
Conditions, like used in JavaScript conditional statements, must evaluate to some truth value.
Expressions typically evaluate some variable(s) or call a method. 
</p>
<p>
Conditions and actions are parsed before program synthesis to extract the variable names that
must be passed to the JS engine before executing the program and reading from it after the execution.
JS keywords are not to be used.
In the following we describe in more detail the restrictions and extensions available
in the current implementation.
</p>

<h2>Conditions</h2>

<p>Conditions are to be presented as JS comparisons (expressions). 
The following operators are supported:
<, >, ==, !=, <=, >=, +, -, *, /, %, ||, &&, !, &, |, ~, ^, <<, >>.
</p>

<p>Typical conditions look as follows: 
</p>

<pre>
i<limit
gateIsOpen
a+b > c/d && a < d
</pre>

<p>See <em>Language description in BNF</em> for more detailed description
</p>

<h2>Actions</h2>

<p>Actions are to be presented as JS programs (sequence of JS statements, separated by a semicolon). 
A typical statement is an evaluation: <code>x = expression;</code>, where 
<code>x</code> is a variable that is evaluated with the result of the <code>expression</code>.
In addition to the standard evaluation with the operator "=" the following evaluating 
statements are allowed:
<pre>
<code>x++;</code>
<code>x--;</code>
<code>x += expression;</code>
<code>x -= expression;</code>
<code>x *= expression;</code>
<code>x /= expression;</code>
<code>x %= expression;</code>
<code>[x,y]=[Model |- in1, in2 -> out1, out2](arg1,arg2);</code>
</pre>
</p>

<p>The latter is called an (independent) subtask and represents a method to be 
synthesised by CoCoViLa.
The method computes out1 and out2 from given in1 and in2 on a Model. 
The Model could be a CoCoViLa visual class or scheme. 
When called, the arg1 and arg2 are passed to the method as in1 and in2. 
The values of out1 and out2 are assigned to x and y.   
</p>

<p>See <em>Language description in BNF</em> for more detailed description
</p>

<h2>Expressions</h2>

<p>An expression is a formula or a mix of formulas and method calls that evaluates to a single value. 
</p>

<h2>Language description in BNF</h2>

<p>The following is the description of the language used in conditions and actions in 
<a href="http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form">BNF</a>.
</p>
<xmp>
<condition> ::= &ltexpression>
<action> ::= &ltprogram>

&ltarithmetic-op> ::= "+" | "-" | "*" | "/" | "%"
&ltbinary-op> :== &ltarithmetic-op> | &ltlogic-op> | &ltcomparison-op>
&ltcomparison-op> ::=  "==" | "!=" | "<" | ">" | "<=" | ">="
&lteval-op> ::= "=" | "+=" | "-=" | "*=" | "/=" | "%="
&ltevaluation> ::= &ltname> &lteval-op>  &ltexpression>
&ltexpression> ::= &ltname> | &ltvalue> | &ltexpression> &ltbinary-op> &ltexpression> | "(" &ltexpression> ")" | 
&ltexpression-list> ::= &ltexpression> | &ltexpression> "," &ltexpression-list>
&ltlogic-op> ::= "||" | "&&" | "!" | "&" | "|" | "~" | "^" | "<<" | ">>"
&ltmethod-call> ::= &ltname> "(" &ltexpression-list> ")"
&ltname> ::= &ltalpha-num> | &ltname> "[" &ltexpression> "]" | &ltname> "." &ltname>
&ltname-list> ::= &ltname> | &ltname> "," &ltname-list>
&ltprogram> ::= &ltstatement> | &ltstatement> ";" &ltprogram>
&ltstatement> ::= &ltevaluation> | &ltunary-evaluation> | &ltmethod-call> | &ltsubtask-evaluation>
&ltsubtask-evaluation> ::= "[" &ltname-list> "]" = "[" &ltalpha-num> "|-" &ltname-list> "->" &ltname-list> "]" "(" &ltexpression-list> ")"
&ltunary-evaluation> ::= &ltname> "+" "+" | &ltname> "-" "-"
&ltvalue> ::= &ltnumber> | '"' &lttext> '"' 

&ltalpha-num> - sequence of alphabetical and numeric characters that starts with a letter
&ltnumber> - sequence of numeric characters
&lttext> - any sequence of characters
</xmp>

<p>Next: <a href="mm2object.html" class="inner-link">Create a new Scheme Object from the drawn scheme</a></p>

  </div>
  </div>